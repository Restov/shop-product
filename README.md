# Отчёт по безопасности 
## XSS-уязвимости
### XSS — тип атаки на веб-системы, заключающийся во внедрении в выдаваемую веб-системой страницу вредоносного кода и взаимодействии этого кода с веб-сервером злоумышленника. Является разновидностью атаки «Внедрение кода».
На сайт невозможно внедрить скрипты или стили в связи с тем, что пользователь нигде не влияет на контент страницы.
## SQL Injection
### Внедрение SQL-кода — один из распространённых способов взлома сайтов и программ, работающих с базами данных, основанный на внедрении в запрос произвольного SQL-кода.
При использовании GET запросов 

В products или product используется валидация полей GET запроса

Например:

![](https://i.imgur.com/SFqqB3W.png)

В коде идет обработка запроса:
```php
if (!isset($get['cat_id'])) {
    header('Location: 404.php');
    exit;
}

if (!isset($get['page'])) {
    $page = 1;
} else {
    $get_page = (int)$get['page'];
    if($get_page < 1){
        header('Location: 404.php');
        exit;
    }
    $page = $get_page;
}
$offset = ceil(($page - 1) * 12);

$id = $get['cat_id'];
if (!is_numeric($id)) {
    header('Location: 404.php');
    exit;
}

    return array($id, $offset, $page);
```

При попытке выполнить данный запрос произойдет редирект на страницу 404.

При использовании POST запроса

При попытке ввести данные в поля формы обратной связи, они валидируются:
```php
function validateInput($i)
{
    $i = trim($i);
    $i = stripslashes($i);
    $i = htmlspecialchars($i);
    return $i;
}
```
Если указать в форме кавычки или спец.символы HTML, в базе данных окажутся конвертированные сущности.

Пример:

![](https://i.imgur.com/mhIzeFv.png)

Следовательно, данная валидация не позволит внедрить вредоносный SQL код в БД.
> Использование подготовленных запросов из PDO достаточно для предотвращения SQL-инъекций при постоянном использовании для каждого запроса.
## CSRF 
### CSRF — вид атак на посетителей веб-сайтов, использующий недостатки протокола HTTP. Если жертва заходит на сайт, созданный злоумышленником, от её лица тайно отправляется запрос на другой сервер, осуществляющий некую вредоносную операцию.

Для защиты от данной атаки в коде создается сессия и в нее помещается сгенерированный токен.
При попытке отправить запрос с несовпадающим сессионным токеном, запрос в БД не будет отправлен.
```php
session_start();
```
```php
if($_POST['token'] != $_SESSION['token']){
    die();
}
```
```php
{
    $_SESSION['token'] = bin2hex(random_bytes(32));
}
```
Токен в форме
```php
<input type="hidden" name="token" value="<?= $_SESSION['token'] ?>">
```

